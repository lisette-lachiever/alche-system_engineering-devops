#!/bin/bash
# 1-run_nginx_as_nginx

# Ensure Nginx configuration allows running as nginx user
NGINX_CONF="/etc/nginx/nginx.conf"

# Backup original config
cp $NGINX_CONF "${NGINX_CONF}.bak"

# Change user to nginx
sed -i 's/^user .*/user nginx;/' $NGINX_CONF

# Change port to 8080 and listen on all IPs
sed -i 's/listen 80 default_server;/listen 8080;/' $NGINX_CONF
sed -i 's/listen \[::\]:80 default_server;/listen [::]:8080;/' $NGINX_CONF

# Reload Nginx if running
if pgrep nginx > /dev/null; then
    nginx -s reload
else
    nginx
fi
